Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Page     1-1


       1				.386 
       2 0000				rozkazy SEGMENT use16 
       3						ASSUME	cs:rozkazy 
       4				 
       5 0000				clear PROC 
       6 0000  50				push	ax 
       7 0001  53				push	bx 
       8 0002  06				push	es 
       9				 
      10 0003  B8 A000				mov		ax, 0A000H 
      11 0006  8E C0				mov		es, ax 
      12				 
      13 0008  B0 00				mov		al, 0 
      14 000A  BB 0000				mov		bx, 0 
      15 000D				ptl: 
      16 000D  26: 88 07			mov		es:[bx], al ; w
					pisanie kodu koloru do pamiêci ekranu 
      17 0010  83 C3 01				add		bx, 1 
      18 0013  81 FB FA00			cmp		bx, 320*200 
      19 0017  72 F4				jb		ptl 
      20				 
      21 0019  07				pop		es 
      22 001A  5B				pop		bx 
      23 001B  58				pop		ax 
      24 001C  C3				ret 
      25 001D				clear ENDP 
      26				 
      27 001D				rysuj_kwadrat PROC 
      28 001D  50				push	ax 
      29 001E  53				push	bx 
      30 001F  06				push	es 
      31 0020  51				push	cx 
      32 0021  52				push	dx 
      33 0022  2E: FF 36 0151 R			push	cs:krawedz 
      34					 
      35 0027  E8 0000 R			call	clear 
      36					 
      37 002A  B8 A000				mov		ax, 0A000H 
      38 002D  8E C0				mov		es, ax 
      39				 
      40				 
      41 002F  2E: 8B 1E 0153 R			mov		bx, cs:start_x 
      42 0034  2E: 03 1E 0155 R			add		bx, cs:start_y 
      43 0039  2E: 01 1E 0151 R			add		cs:krawedz, bx 
      44					 
      45 003E  B9 0064				mov		cx, 100 
      46 0041  2E: A0 014D R			mov		al, cs:kolor 
      47 0045  2E: 8B 16 0151 R			mov		dx, cs:krawedz 
      48					 
      49 004A				kw:	 
      50 004A  26: 88 07			mov		es:[bx], al ; w
					pisanie kodu koloru do pamiêci ekranu 
      51 004D  43				inc		bx 
      52 004E  2E: 3B 1E 0151 R			cmp		bx, cs:krawedz 
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Page     1-2


      53 0053  72 F5				jb		kw 
      54					 
      55 0055  81 C3 00A0			add		bx, 160 
      56 0059  2E: 81 06 0151 R 0140		add		cs:krawedz, 320
					 
      57					 
      58 0060  49				dec		cx 
      59 0061  83 F9 00				cmp		cx, 0 
      60 0064  77 E4				ja		kw 
      61				 
      62				 
      63 0066  2E: 8F 06 0151 R			pop		cs:krawedz 
      64 006B  5A				pop		dx 
      65 006C  59				pop		cx 
      66 006D  07				pop		es 
      67 006E  5B				pop		bx 
      68 006F  58				pop		ax 
      69 0070  C3				ret 
      70 0071				rysuj_kwadrat ENDP 
      71				 
      72 0071				obsluga_klawy PROC 
      73 0071  50				push	ax 
      74 0072  53				push	bx 
      75 0073  06				push	es 
      76				 
      77 0074  E4 60				in		al, 60h 
      78 0076  3C 48				cmp		al, 72 
      79 0078  0F 85 008D R			jne		nie_gorna_strza
					lka 
      80 007C  2E: 83 3E 0155 R 00		cmp		cs:start_y, 0 
      81 0082  0F 84 00D4 R			je		nie_prawa_strza
					lka 
      82 0086  2E: 81 2E 0155 R 7D00		sub		cs:start_y, 320
					00 
      83 008D				nie_gorna_strzalka: 
      84 008D  3C 50				cmp		al, 80 
      85 008F  0F 85 00A5 R			jne		nie_dolna_strza
					lka 
      86 0093  2E: 81 3E 0155 R 7D00		cmp		cs:start_y, 320
					00 
      87 009A  0F 84 00D4 R			je		nie_prawa_strza
					lka 
      88 009E  2E: 81 06 0155 R 7D00		add		cs:start_y, 320
					00 
      89 00A5				nie_dolna_strzalka: 
      90 00A5  3C 4B				cmp		al, 75 
      91 00A7  0F 85 00BC R			jne		nie_lewa_strzal
					ka 
      92 00AB  2E: 83 3E 0153 R 00		cmp		cs:start_x, 0 
      93 00B1  0F 84 00D4 R			je		nie_prawa_strza
					lka 
      94 00B5  2E: 81 2E 0153 R 00A0		sub		cs:start_x, 160
					 
      95 00BC				nie_lewa_strzalka: 
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Page     1-3


      96 00BC  3C 4D				cmp		al, 77 
      97 00BE  0F 85 00D4 R			jne		nie_prawa_strza
					lka 
      98 00C2  2E: 81 3E 0153 R 00A0		cmp		cs:start_x, 160
					 
      99 00C9  0F 84 00D4 R			je		nie_prawa_strza
					lka 
     100 00CD  2E: 81 06 0153 R 00A0		add		cs:start_x, 160
					 
     101 00D4				nie_prawa_strzalka: 
     102				 
     103 00D4  07				pop		es 
     104 00D5  5B				pop		bx 
     105 00D6  58				pop		ax 
     106				 
     107 00D7  2E: FF 2E 0145 R			jmp		dword ptr cs:we
					ktor9 
     108 00DC				obsluga_klawy ENDP 
     109				 
     110 00DC				linia PROC 
     111 00DC  50				push	ax 
     112 00DD  53				push	bx 
     113 00DE  06				push	es 
     114				 
     115					 
     116 00DF  2E: 66| FF 0E 0149 R		dec dword ptr cs:czas_oczekiwan
					ia  
     117 00E5  0F 85 0133 R			jnz skip 
     118 00E9  2E: 66| C7 06 0149 R		mov	dword ptr cs:czas_oczek
					iwania, 18 
     119       00000012			
     120				 
     121 00F3  2E: A0 014E R			mov	al, cs:kolor_czer 
     122 00F7  2E: 38 06 014D R			cmp	cs:kolor, al 
     123 00FC  0F 85 010B R			jne	nie_czerw 
     124 0100  2E: A0 014F R			mov	al, cs:kolor_ziel 
     125 0104  2E: A2 014D R			mov cs:kolor, al 
     126 0108  EB 21 90				jmp	dal 
     127 010B				nie_czerw: 
     128 010B  2E: A0 014F R			mov	al, cs:kolor_ziel 
     129 010F  2E: 38 06 014D R			cmp	cs:kolor, al 
     130 0114  0F 85 0123 R			jne	nie_ziel 
     131 0118  2E: A0 0150 R			mov	al, cs:kolor_nieb 
     132 011C  2E: A2 014D R			mov cs:kolor, al 
     133 0120  EB 09 90				jmp	dal 
     134 0123				nie_ziel: 
     135 0123  2E: A0 014E R			mov	al, cs:kolor_czer 
     136 0127  2E: A2 014D R			mov cs:kolor, al 
     137 012B				dal: 
     138				 
     139 012B				rysuj: 
     140				 
     141 012B  E8 001D R			call	rysuj_kwadrat 
     142				 
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Page     1-4


     143				 
     144					; zapisanie adresu bie¿¹cego pi
					ksela 
     145 012E				dalej: 
     146 012E  2E: 89 1E 013D R			mov		cs:adres_piksel
					a, bx 
     147 0133				skip: 
     148 0133  07				pop		es 
     149 0134  5B				pop		bx 
     150 0135  58				pop		ax 
     151				 
     152 0136  2E: FF 2E 0141 R			jmp		dword ptr cs:we
					ktor8 
     153				 
     154					;zmienne 
     155 013B  0000				licznik			dw
						0 
     156 013D  000A				adres_piksela	dw	10 
     157 013F  0000				przyrost		dw
						0 
     158 0141  ????????				wektor8			dd
						? 
     159 0145  ????????				wektor9			dd
						? 
     160 0149  05000000				czas_oczekiwania dd 5 
     161 014D  ??				kolor		db ? 
     162 014E  04				kolor_czer	db 4 
     163 014F  02				kolor_ziel	db 2 
     164 0150  01				kolor_nieb	db 1 
     165 0151  00A0				krawedz		dw	160 
     166 0153  0000				start_x		dw	0 
     167 0155  0000				start_y		dw	0 
     168 0157  0000				kierunek	dw	0 
     169				 
     170 0159				linia ENDP 
     171				 
     172 0159				zacznij: 
     173 0159  B4 00				mov ah, 0 
     174 015B  B0 13				mov al, 13H		
									; nr tr
					ybu 
     175 015D  CD 10				int 10H 
     176 015F  BB 0000				mov bx, 0 
     177 0162  8E C3				mov es, bx		
									; zerow
					anie rejestru ES 
     178 0164  26: 66| A1 0020			mov eax, es:[32]	
								; odczytanie we
					ktora nr 8 
     179 0169  2E: 66| A3 0141 R		mov cs:wektor8, eax	
								; zapamiêtanie 
					wektora nr 8 
     180				 
     181 016E  26: 66| A1 0024			mov eax, es:[36]	
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Page     1-5


								; odczytanie we
					ktora nr 9 
     182 0173  2E: 66| A3 0145 R		mov cs:wektor9, eax	
								; zapamiêtanie 
					wektora nr 9 
     183				 
     184					; adres procedury 'kwadrat' w p
					ostaci segment:offset 
     185 0178  B8 ---- R			mov ax, SEG linia 
     186 017B  BB 00DC R			mov bx, OFFSET linia 
     187				 
     188 017E  FA				cli			
									
						 
     189 017F  26: 89 1E 0020			mov es:[32], bx 
     190 0184  26: A3 0022			mov es:[32+2], ax 
     191 0188  FB				sti			
									
						 
     192				 
     193 0189  B8 ---- R			mov ax, SEG obsluga_klawy 
     194 018C  BB 0071 R			mov bx, OFFSET obsluga_klawy 
     195				 
     196 018F  FA				cli 
     197 0190  26: 89 1E 0024			mov es:[36], bx 
     198 0195  26: A3 0026			mov es:[36+2], ax 
     199 0199  FB				sti 
     200				 
     201				 
     202 019A				aktywne_oczekiwanie: 
     203 019A  B4 01				mov		ah, 1 
     204 019C  CD 16				int		16H 
     205 019E  74 FA				jz		aktywne_oczekiw
					anie 
     206				 
     207 01A0  B4 00				mov		ah, 0 
     208 01A2  CD 16				int		16H 
     209 01A4  3C 78				cmp		al, 'x'	
									
							 
     210 01A6  75 F2				jne aktywne_oczekiwanie	 
     211				 
     212 01A8  B4 00				mov ah, 0		
									; funkc
					ja nr 0 ustawia tryb sterownika 
     213 01AA  B0 03				mov al, 3H		
									; nr tr
					ybu 
     214 01AC  CD 10				int 10H 
     215				 
     216					; odtworzenie oryginalnej zawar
					toœci wektora nr 8 
     217 01AE  2E: 66| A1 0141 R		mov eax, cs:wektor8 
     218 01B3  26: 66| A3 0020			mov es:[32], eax 
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Page     1-6


     219				 
     220					; odtworzenie oryginalnej zawar
					toœci wektora nr 9 
     221 01B8  2E: 66| A1 0145 R		mov eax, cs:wektor9 
     222 01BD  26: 66| A3 0024			mov es:[36], eax 
     223				 
     224					; zakoñczenie wykonywania progr
					amu 
     225 01C2  B8 4C00				mov ax, 4C00H 
     226 01C5  CD 21				int 21H 
     227 01C7				rozkazy ENDS 
     228				 
     229 0000				stosik	SEGMENT stack 
     230 0000  0100[				db	256	dup	(?) 
     231	    ??			
     232			 ]	
     233				
     234 0100				stosik	ENDS 
     235				 
     236				END zacznij 
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Symbols-1




                N a m e         	Size	Length	 Align	Combine Class

ROZKAZY  . . . . . . . . . . . .  	16 Bit	01C7	PARA	NONE	
STOSIK . . . . . . . . . . . . .  	32 Bit	0100	PARA	STACK	

Symbols:            

                N a m e         	Type	 Value	 Attr

ADRES_PIKSELA  . . . . . . . . .  	L WORD	013D	ROZKAZY
AKTYWNE_OCZEKIWANIE  . . . . . .  	L NEAR	019A	ROZKAZY

CLEAR  . . . . . . . . . . . . .  	N PROC	0000	ROZKAZY	Length = 001D
CZAS_OCZEKIWANIA . . . . . . . .  	L DWORD	0149	ROZKAZY

DAL  . . . . . . . . . . . . . .  	L NEAR	012B	ROZKAZY
DALEJ  . . . . . . . . . . . . .  	L NEAR	012E	ROZKAZY

KIERUNEK . . . . . . . . . . . .  	L WORD	0157	ROZKAZY
KOLOR  . . . . . . . . . . . . .  	L BYTE	014D	ROZKAZY
KOLOR_CZER . . . . . . . . . . .  	L BYTE	014E	ROZKAZY
KOLOR_NIEB . . . . . . . . . . .  	L BYTE	0150	ROZKAZY
KOLOR_ZIEL . . . . . . . . . . .  	L BYTE	014F	ROZKAZY
KRAWEDZ  . . . . . . . . . . . .  	L WORD	0151	ROZKAZY
KW . . . . . . . . . . . . . . .  	L NEAR	004A	ROZKAZY

LICZNIK  . . . . . . . . . . . .  	L WORD	013B	ROZKAZY
LINIA  . . . . . . . . . . . . .  	N PROC	00DC	ROZKAZY	Length = 007D

NIE_CZERW  . . . . . . . . . . .  	L NEAR	010B	ROZKAZY
NIE_DOLNA_STRZALKA . . . . . . .  	L NEAR	00A5	ROZKAZY
NIE_GORNA_STRZALKA . . . . . . .  	L NEAR	008D	ROZKAZY
NIE_LEWA_STRZALKA  . . . . . . .  	L NEAR	00BC	ROZKAZY
NIE_PRAWA_STRZALKA . . . . . . .  	L NEAR	00D4	ROZKAZY
NIE_ZIEL . . . . . . . . . . . .  	L NEAR	0123	ROZKAZY

OBSLUGA_KLAWY  . . . . . . . . .  	N PROC	0071	ROZKAZY	Length = 006B

PRZYROST . . . . . . . . . . . .  	L WORD	013F	ROZKAZY
PTL  . . . . . . . . . . . . . .  	L NEAR	000D	ROZKAZY

RYSUJ  . . . . . . . . . . . . .  	L NEAR	012B	ROZKAZY
RYSUJ_KWADRAT  . . . . . . . . .  	N PROC	001D	ROZKAZY	Length = 0054

SKIP . . . . . . . . . . . . . .  	L NEAR	0133	ROZKAZY
START_X  . . . . . . . . . . . .  	L WORD	0153	ROZKAZY
START_Y  . . . . . . . . . . . .  	L WORD	0155	ROZKAZY

WEKTOR8  . . . . . . . . . . . .  	L DWORD	0141	ROZKAZY
WEKTOR9  . . . . . . . . . . . .  	L DWORD	0145	ROZKAZY

ZACZNIJ  . . . . . . . . . . . .  	L NEAR	0159	ROZKAZY
Microsoft (R) Macro Assembler Version 5.00                  1/5/24 09:38:57
                                                             Symbols-2



@FILENAME  . . . . . . . . . . .  	TEXT  l		


    232 Source  Lines
    232 Total   Lines
     36 Symbols

  50520 + 466024 Bytes symbol space free

      0 Warning Errors
      0 Severe  Errors
